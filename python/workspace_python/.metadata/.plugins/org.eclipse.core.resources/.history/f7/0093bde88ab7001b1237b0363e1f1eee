<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript" src="jquery-3.6.0.js"></script>
<script type="text/javascript">
		function fn_setTable(e_id, e_name, birth){
			$("#e_id").val(e_id);
			$("#e_name").val(e_name);
			$("#birth").val(birth);
		}
		function fn_add(){
			var param = {
		            'e_id':$("#e_id").val(), 
		            'e_name':$("#e_name").val(), 
		            'birth':$("#birth").val()
		        }
			$.ajax({
		        type: 'POST',
		        url: 'add.ajax',
		        data: JSON.stringify(param),
		        dataType : 'JSON',
		        contentType: "application/json",
		        success: function(data){
		        	if(data.msg == 'ok'){
		        		alert('정상추가');
		        		location.reload();
		        	}else{
		        		alert('실행도중 에러');
		        	}
		        },
		        error: function(request, status, error){
		            alert('ajax 통신 실패')
		        }
		    })
		}
		
		function fn_upd(){
			var param = {
		            'e_id':$("#e_id").val(), 
		            'e_name':$("#e_name").val(), 
		            'birth':$("#birth").val()
		        }
			$.ajax({
		        type: 'POST',
		        url: 'upd.ajax',
		        data: JSON.stringify(param),
		        dataType : 'JSON',
		        contentType: "application/json",
		        success: function(data){
		        	if(data.msg == 'ok'){
		        		alert('정상수정');
		        		location.reload();
		        	}else{
		        		alert('실행도중 에러');
		        	}
		        },
		        error: function(request, status, error){
		            alert('ajax 통신 실패')
		        }
		    })
		}
		
		function fn_del(){
			var param = {
		            'e_id':$("#e_id").val(), 
		            'e_name':$("#e_name").val(), 
		            'birth':$("#birth").val()
		        }
			$.ajax({
		        type: 'POST',
		        url: 'del.ajax',
		        data: JSON.stringify(param),
		        dataType : 'JSON',
		        contentType: "application/json",
		        success: function(data){
		        	if(data.msg == 'ok'){
		        		alert('정상삭제');
		        		location.reload();
		        	}else{
		        		alert('실행도중 에러');
		        	}
		        },
		        error: function(request, status, error){
		            alert('ajax 통신 실패')
		        }
		    })
		}
</script>
</head>
<body>
	<table border="1" id="list">
		<tr>
			<th>ID</th>
			<th>NAME</th>
			<th>BIRTH</th>
		</tr>
		{%for emp in mylist %}
		<tr>
			<td><a href="javascript:fn_setTable('{{emp.e_id}}','{{emp.e_name}}','{{emp.birth}}')">{{emp.e_id}}</a></td>
			<td>{{emp.e_name}}</td>
  			<td>{{emp.birth}}</td>
  		</tr>
		{% endfor %}
	</table>
	<table border="1" id="detail">
		<tr>
			<th>ID</th>
			<td colspan="2"><input type="text" id="e_id"></td>
		</tr>
		<tr>
			<th>NAME</th>
			<td colspan="2"><input type="text" id="e_name"></td>
  		</tr>
  		<tr>
			<th>BIRTH</th>
  			<td colspan="2"><input type="text" id="birth"></td>
  		</tr>
  		<tr>
  			<td><button onclick="fn_add()">추가</button></td>
  			<td><button onclick="fn_upd()">수정</button></td>
  			<td><button onclick="fn_del()">삭제</button></td>
  		</tr>
	</table>
</body>
</html>